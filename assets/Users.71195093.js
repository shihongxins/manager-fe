var e=Object.defineProperty,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,r=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,o=(e,o)=>{for(var s in o||(o={}))l.call(o,s)&&r(e,s,o[s]);if(a)for(var s of a(o))t.call(o,s)&&r(e,s,o[s]);return e};import{u as s}from"./index.03b6c02e.js";import u from"./UserOperateDialog.b8ac66e1.js";import{u as i,s as n,v as p,r as d,x as m,o as g,c,a as b,w as h,y as f,F as y,d as D,e as w,z as _,b as S}from"./vendor.9586058d.js";const C={name:"Users",components:{UserOperateDialog:u},setup(){const{ctx:e}=_(),{tableColumns:a,userList:l,query:t,pageData:r,getUserList:u,handleQuerySubmit:d,showDialog:m}=(e=>{const a=[{label:"用户 ID",prop:"userId",width:80},{label:"用户名称",prop:"userName"},{label:"用户邮箱",prop:"userEmail",width:200},{label:"用户角色",prop:"role",formatter:(e,a,l)=>({0:"普通用户",1:"管理员"}[l])},{label:"用户状态",prop:"state",formatter:(e,a,l)=>({1:"试用",2:"在职",3:"离职"}[l])},{label:"注册时间",prop:"createTime",formatter:(e,a,l)=>s.formatterDateTime(l),width:90},{label:"最后登录",prop:"lastLoginTime",formatter:(e,a,l)=>s.formatterDateTime(l),width:90}],l=i([]),t=n({userId:"",userName:"",state:2}),r=n({pageNum:1,pageSize:10,total:0}),u=async()=>{const a=o(o({},r),t),{page:s,list:u}=await e.$api.getUserList(a);s&&u&&(l.value=u,r.total=s.total)};return p((()=>{u()})),{tableColumns:a,userList:l,query:t,pageData:r,getUserList:u,handleQuerySubmit:a=>{const{reset:l,pageNum:t,pageSize:o}=a;l&&e.$refs.queryForm.resetFields(),r.pageNum=t||1,r.pageSize=o||10,u()},showDialog:(a,l,t)=>{e.$refs.userOperateDialog.handleToggleDialogShow(a,l,t)}}})(e);return o({tableColumns:a,userList:l,query:t,pageData:r,getUserList:u,handleQuerySubmit:d,showDialog:m},((e,a)=>{const l=i([]),t=async l=>{l.length>0?await e.$api.userDel({userIds:l})>0?(e.$message.success("删除成功！"),a()):e.$message.error("删除失败！"):e.$message.warning("请先选中数据！")};return{handleSelectionChange:e=>{l.value=e},handleSingleDel:e=>{e&&e._id&&t([e.userId])},handlePatchDel:()=>{const e=[];l.value.forEach((a=>{a&&a._id&&e.push(a.userId)})),t(e)}}})(e,u))}},v={class:"content_wrapper"},U={class:"query_form_wrapper"},z=S("查询"),k=S("重置"),q={class:"table_container"},I={class:"table_tools"},L=S("新增"),N=S("批量删除"),O={class:"table_content"},V=S("编辑"),j=S("删除");C.render=function(e,a,l,t,r,o){const s=d("el-input"),u=d("el-form-item"),i=d("el-option"),n=d("el-select"),p=d("el-button"),_=d("el-form"),S=d("el-table-column"),C=d("el-table"),Q=d("el-pagination"),$=d("UserOperateDialog"),x=m("has");return g(),c("div",v,[b("div",U,[b(_,{inline:!0,model:t.query,ref:"queryForm"},{default:h((()=>[b(u,{label:"用户 ID",prop:"userId"},{default:h((()=>[b(s,{modelValue:t.query.userId,"onUpdate:modelValue":a[1]||(a[1]=e=>t.query.userId=e),placeholder:"请输入用户 ID"},null,8,["modelValue"])])),_:1}),b(u,{label:"用户名称",prop:"userName"},{default:h((()=>[b(s,{modelValue:t.query.userName,"onUpdate:modelValue":a[2]||(a[2]=e=>t.query.userName=e),placeholder:"请输入用户名称"},null,8,["modelValue"])])),_:1}),b(u,{label:"用户状态",prop:"state"},{default:h((()=>[b(n,{modelValue:t.query.state,"onUpdate:modelValue":a[3]||(a[3]=e=>t.query.state=e),placeholder:"请选择用户状态"},{default:h((()=>[b(i,{label:"所有",value:0}),b(i,{label:"试用",value:1}),b(i,{label:"在职",value:2}),b(i,{label:"离职",value:3})])),_:1},8,["modelValue"])])),_:1}),b(u,null,{default:h((()=>[b(p,{type:"primary",onClick:t.handleQuerySubmit},{default:h((()=>[z])),_:1},8,["onClick"]),b(p,{onClick:a[4]||(a[4]=e=>t.handleQuerySubmit({reset:!0}))},{default:h((()=>[k])),_:1})])),_:1})])),_:1},8,["model"])]),b("div",q,[b("div",I,[f(b(p,{type:"primary",onClick:a[5]||(a[5]=e=>t.showDialog(!0,"add"))},{default:h((()=>[L])),_:1},512),[[x,"user-add"]]),f(b(p,{type:"danger",onClick:e.handlePatchDel},{default:h((()=>[N])),_:1},8,["onClick"]),[[x,"user-patchDel"]])]),b("div",O,[b(C,{onSelectionChange:e.handleSelectionChange,data:t.userList,stripe:""},{default:h((()=>[b(S,{type:"selection",width:"55"}),(g(!0),c(y,null,D(t.tableColumns,(e=>(g(),c(S,{key:e.prop,prop:e.prop,label:e.label,width:e.width,formatter:e.formatter},null,8,["prop","label","width","formatter"])))),128)),b(S,{label:"操作"},{default:h((a=>[f(b(p,{size:"mini",onClick:e=>t.showDialog(!0,"edit",a.row)},{default:h((()=>[V])),_:2},1032,["onClick"]),[[x,"user-edit"]]),1!=a.row.role?f((g(),c(p,{key:0,size:"mini",type:"danger",onClick:l=>e.handleSingleDel(a.row)},{default:h((()=>[j])),_:2},1032,["onClick"])),[[x,"user-singleDel"]]):w("",!0)])),_:1})])),_:1},8,["onSelectionChange","data"]),b(Q,{onSizeChange:a[6]||(a[6]=e=>{t.handleQuerySubmit({pageSize:e})}),onCurrentChange:a[7]||(a[7]=e=>{t.handleQuerySubmit({pageNum:e})}),"current-page":t.pageData.pageNum,"onUpdate:current-page":a[8]||(a[8]=e=>t.pageData.pageNum=e),"page-sizes":[10,20,50,100],"page-size":t.pageData.pageSize,"onUpdate:page-size":a[9]||(a[9]=e=>t.pageData.pageSize=e),total:t.pageData.total,class:"table_pagination",layout:"total, sizes, prev, pager, next, jumper",background:""},null,8,["current-page","page-size","total"])])]),b($,{ref:"userOperateDialog",getUserList:t.getUserList},null,8,["getUserList"])])};export default C;
