var e=Object.defineProperty,t=Object.defineProperties,o=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,a=(t,o,r)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[o]=r,i=(e,t)=>{for(var o in t||(t={}))s.call(t,o)&&a(e,o,t[o]);if(r)for(var o of r(t))n.call(t,o)&&a(e,o,t[o]);return e},l=(e,r)=>t(e,o(r));import{r as u,o as c,c as m,a as d,w as p,b as g,d as f,F as _,t as h,e as v,m as y,f as L,g as w,h as b,i as I,j as O,n as E,k as D,I as P}from"./vendor.9586058d.js";let C;const M={},T=function(e,t){if(!t)return e();if(void 0===C){const e=document.createElement("link").relList;C=e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}return Promise.all(t.map((e=>{if(e in M)return;M[e]=!0;const t=e.endsWith(".css"),o=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${o}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":C,t||(r.as="script",r.crossOrigin=""),r.href=e,document.head.appendChild(r),t?new Promise(((e,t)=>{r.addEventListener("load",e),r.addEventListener("error",t)})):void 0}))).then((()=>e()))};const $={name:"Login",data:()=>({onLogin:!1,userInfo:{userName:"",userPwd:""},rules:{userName:{required:!0,message:"用户账号不能为空",trigger:"blur"},userPwd:{required:!0,message:"用户密码不能为空",trigger:"blur"}}}),methods:{login(){this.onLogin=!0,this.$refs.loginForm.validate((async e=>{if(e){const e=await this.$api.login(this.userInfo.userName,this.userInfo.userPwd);e&&e.userName?(this.$store.commit("saveUserInfo",e),await this.$api.getPermissionList(),this.$router.push({name:"Home"})):this.$message.error("登录失败！"),this.onLogin=!1}}))}}},j={class:"login_wrapper"},A={class:"login_container"},R=d("h2",{class:"login_title"},"员工后台管理系统",-1),U=g("登录"),k=g("忘记密码");$.render=function(e,t,o,r,s,n){const a=u("el-input"),i=u("el-form-item"),l=u("el-button"),g=u("el-form");return c(),m("div",j,[d("div",A,[R,d(g,{ref:"loginForm","label-width":"4em",model:s.userInfo,rules:s.rules,"status-icon":""},{default:p((()=>[d(i,{label:"账号",prop:"userName"},{default:p((()=>[d(a,{type:"text",autocomplete:"off","prefix-icon":"el-icon-lock",modelValue:s.userInfo.userName,"onUpdate:modelValue":t[1]||(t[1]=e=>s.userInfo.userName=e)},null,8,["modelValue"])])),_:1}),d(i,{label:"密码",prop:"userPwd"},{default:p((()=>[d(a,{type:"password",autocomplete:"off","prefix-icon":"el-icon-key","show-password":"",modelValue:s.userInfo.userPwd,"onUpdate:modelValue":t[2]||(t[2]=e=>s.userInfo.userPwd=e)},null,8,["modelValue"])])),_:1}),d(i,{class:"login_button_container"},{default:p((()=>[d(l,{type:"primary",loading:s.onLogin,onClick:n.login},{default:p((()=>[U])),_:1},8,["loading","onClick"]),d(l,{type:"text"},{default:p((()=>[k])),_:1})])),_:1})])),_:1},8,["model","rules"])])])};var S=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:$});const V={name:"TreeMenu",props:{menuList:{type:[Array,Object],default:()=>[]}}};V.render=function(e,t,o,r,s,n){const a=u("TreeMenu",!0),i=u("el-submenu"),l=u("el-menu-item");return c(!0),m(_,null,f(o.menuList,(e=>(c(),m(_,null,[e.children&&e.children.length&&1==e.children[0].menuType?(c(),m(i,{key:e._id,index:e.path},{title:p((()=>[d("i",{class:e.icon},null,2),d("span",null,h(e.menuName),1)])),default:p((()=>[d(a,{menuList:e.children},null,8,["menuList"])])),_:2},1032,["index"])):1==e.menuType?(c(),m(l,{key:e._id,index:e.path},{default:p((()=>[g(h(e.menuName),1)])),_:2},1032,["index"])):v("",!0)],64)))),256)};var N=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:V});const x={name:"Home",components:{TreeMenu:V},data:()=>({menuCollapsed:!1,showUserInfoDialog:!1}),computed:l(i({},y({noticeCount:"noticeCount",loginUser:"userInfo",menuList:"permissionMenuList"})),{breadCrumb(){return this.$route.matched||[]}}),mounted(){this.$api.getNoticeCount()},methods:{handleMenuFoldClick(){this.menuCollapsed=!this.menuCollapsed},handleUserCommand(e){"logout"===e&&(this.$store.commit("logout"),this.$router.push({name:"Login"})),"loginUserDetail"===e&&(this.showUserInfoDialog=!0)}}},B={class:"layout"},H=d("div",{class:"logo"},[d("img",{src:"/manager-fe/assets/logo.3503d5cd.png",alt:"logo",class:"logo_img"}),d("h2",{class:"logo_title"},"Manager")],-1),F={class:"header_container"},q={class:"header-left"},z={class:"header-right"},W={class:"notice"},J=d("i",{class:"el-icon-bell"},null,-1),Y=g("个人信息"),G=g("退出");x.render=function(e,t,o,r,s,n){const a=u("TreeMenu"),i=u("el-menu"),l=u("el-aside"),v=u("el-button"),y=u("el-breadcrumb-item"),L=u("el-breadcrumb"),w=u("el-badge"),b=u("el-avatar"),I=u("el-dropdown-item"),O=u("el-dropdown-menu"),E=u("el-dropdown"),D=u("el-header"),P=u("router-view"),C=u("el-main"),M=u("el-container"),T=u("el-descriptions-item"),$=u("el-descriptions"),j=u("el-dialog");return c(),m("div",B,[d(M,null,{default:p((()=>[d(l,{class:["layout-left",{collapsed:s.menuCollapsed}],width:""},{default:p((()=>[H,d(i,{"background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b",collapse:s.menuCollapsed,router:""},{default:p((()=>[d(a,{menuList:e.menuList},null,8,["menuList"])])),_:1},8,["collapse"])])),_:1},8,["class"]),d(M,{class:"layout-right"},{default:p((()=>[d(D,null,{default:p((()=>[d("div",F,[d("div",q,[d(v,{type:"text",class:"menu_btn",onClick:n.handleMenuFoldClick},{default:p((()=>[d("i",{class:s.menuCollapsed?"el-icon-s-unfold":"el-icon-s-fold"},null,2)])),_:1},8,["onClick"]),d(L,{"separator-class":"el-icon-arrow-right"},{default:p((()=>[(c(!0),m(_,null,f(n.breadCrumb,(e=>(c(),m(y,{key:e.name,to:{path:e.path}},{default:p((()=>[g(h(e.meta.title),1)])),_:2},1032,["to"])))),128))])),_:1})]),d("div",z,[d("div",W,[d(w,{"is-dot":!!e.noticeCount,type:"danger",onClick:t[1]||(t[1]=t=>e.$router.push("/apply/audit"))},{default:p((()=>[J])),_:1},8,["is-dot"])]),d(E,{class:"user",onCommand:n.handleUserCommand},{dropdown:p((()=>[d(O,null,{default:p((()=>[d(I,{command:"loginUserDetail"},{default:p((()=>[Y])),_:1}),d(I,{command:"logout",divided:""},{default:p((()=>[G])),_:1})])),_:1})])),default:p((()=>[d(b,{class:"user_avatar"},{default:p((()=>[g(h(e.loginUser.userName),1)])),_:1})])),_:1},8,["onCommand"])])])])),_:1}),d(C,{class:"main"},{default:p((()=>[d(P)])),_:1})])),_:1}),d(j,{modelValue:s.showUserInfoDialog,"onUpdate:modelValue":t[2]||(t[2]=e=>s.showUserInfoDialog=e),width:300,"before-close":()=>{s.showUserInfoDialog=!1}},{default:p((()=>[d($,{title:"个人信息",column:"1"},{default:p((()=>[d(T,{label:"用户名"},{default:p((()=>[g(h(e.loginUser.userName),1)])),_:1}),d(T,{label:"岗位"},{default:p((()=>[g(h(e.loginUser.job),1)])),_:1}),d(T,{label:"邮箱"},{default:p((()=>[g(h(e.loginUser.userEmail),1)])),_:1}),d(T,{label:"手机"},{default:p((()=>[g(h(e.loginUser.mobile),1)])),_:1}),d(T,{label:"系统身份"},{default:p((()=>[g(h(1==e.loginUser.role?"管理员":"普通用户"),1)])),_:1})])),_:1})])),_:1},8,["modelValue","before-close"])])),_:1})])};var K=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:x});const Q="production";var X=l(i({namespace:"manager",env:Q},{baseAPI:"/api"}),{mock:!0,mockAPI:"https://www.fastmock.site/mock/bcae458fb84360a54496240b47bcbd42/manager"});const Z=X.namespace;var ee={getStorage(){try{return JSON.parse(window.localStorage.getItem(Z)||"{}")}catch(e){return console.error(e),e}},setStorage(e){try{window.localStorage.setItem(Z,JSON.stringify(e))}catch(t){console.error(t)}},getItem(e){return this.getStorage()[e]},setItem(e,t){const o=this.getStorage();o[e]=t,this.setStorage(o)},removeItem(e){const t=this.getStorage();delete t[e],this.setStorage(t)},clear(){this.setStorage({})}},te=L({state:{userInfo:ee.getItem("userInfo")||{},permissionMenuList:ee.getItem("permissionMenuList")||[],permissionBtnList:ee.getItem("permissionBtnList")||[],noticeCount:ee.getItem("noticeCount")||0},getters:{permissionBtnCodeList:e=>e.permissionBtnList.map((e=>e.menuCode))},mutations:{saveUserInfo(e,t){t?(e.userInfo=t,ee.setItem("userInfo",t)):console.log("用户信息不能为空！",t)},savePermissionList(e,t){t?(t.menuList&&(e.permissionMenuList=t.menuList,ee.setItem("permissionMenuList",t.menuList)),t.btnList&&(e.permissionBtnList=t.btnList,ee.setItem("permissionBtnList",t.btnList))):console.log("权限动态菜单与按钮信息不能为空！",t)},saveNoticeCount(e,t){"number"==typeof t&&(e.noticeCount=t,ee.setItem("noticeCount",t))},logout(e){e.userInfo={},ee.removeItem("userInfo"),e.permissionMenuList={},ee.removeItem("permissionMenuList"),e.permissionBtnList={},ee.removeItem("permissionBtnList")}}}),oe={formatterDateTime(e,t){let o=0;if("number"==typeof e)o=e;else if("string"==typeof e)o=new Date(e).getTime();else{if("[object Date]"!==Object.prototype.toString.call(e))return console.error("Invalid datetime"),e;o=e.getTime()}const r=new Date;r.setTime(o);let s=t||"yyyy-MM-dd HH:mm:ss";const n={"y{4}":r.getFullYear().toString(),"y{2}":r.getFullYear().toString().slice(2),"M{2}":`00${r.getMonth()+1}`.slice(-2),"M{1}":(r.getMonth()+1).toString(),"d{2}":`00${r.getDate()}`.slice(-2),"H{2}":`00${r.getHours()}`.slice(-2),"m{2}":`00${r.getMinutes()}`.slice(-2),"m{1}":r.getMinutes().valueOf().toString(),"s{2}":`00${r.getSeconds()}`.slice(-2),"\\.(s|S)+":`.${`000${r.getMilliseconds()}`.slice(-3)}`};return Object.keys(n).forEach((e=>{const t=new RegExp(`(${e})`);t.test(s)&&(s=s.replace(t,n[e]))})),s},spreadTree(e){let t=[];return e.forEach((e=>{t.push(e),e.children&&e.children.length&&(t=t.concat(...this.spreadTree(e.children)))})),t}};const re=[{name:"Login",path:"/login",component:$,meta:{title:"登录"},beforeEnter:(e,t,o)=>{const{userInfo:r}=te.state;r&&r.token?o({path:"/"}):o()}},{name:"Home",path:"/",alias:"/home",component:x,redirect:"/welcome",meta:{title:"首页"},beforeEnter:(e,t,o)=>{ne(),o()},children:[{name:"Welcome",path:"welcome",component:()=>T((()=>import("./Welcome.f2aa95ac.js")),["/manager-fe/assets/Welcome.f2aa95ac.js","/manager-fe/assets/Welcome.0f78db55.css","/manager-fe/assets/vendor.9586058d.js"]),meta:{title:"欢迎使用"}}]},{name:"404",path:"/404",component:()=>T((()=>import("./404.fa0c1a89.js")),["/manager-fe/assets/404.fa0c1a89.js","/manager-fe/assets/404.53e5a0db.css","/manager-fe/assets/vendor.9586058d.js"]),meta:{title:"404"}}],se=w({history:b(),routes:re});se.beforeEach(((e,t,o)=>{const r=se.getRoutes().filter((t=>t.name===e.name&&t.path===e.path));if(!r||!r.length)return void o({name:"404"});document.title=e.meta.title;const{userInfo:s}=te.state;s&&s.token||"/login"===e.path?o():o({path:"/login"})}));const ne=()=>{const{permissionMenuList:e}=te.state,t=oe.spreadTree(e),o=se.getRoutes(),r={"../components/404.vue":()=>T((()=>import("./404.fa0c1a89.js")),["/manager-fe/assets/404.fa0c1a89.js","/manager-fe/assets/404.53e5a0db.css","/manager-fe/assets/vendor.9586058d.js"]),"../components/Home.vue":()=>T((()=>Promise.resolve().then((function(){return K}))),void 0),"../components/TreeMenu.vue":()=>T((()=>Promise.resolve().then((function(){return N}))),void 0),"../views/apply/Audit.vue":()=>T((()=>import("./Audit.eed742c6.js")),["/manager-fe/assets/Audit.eed742c6.js","/manager-fe/assets/Audit.3de94bf5.css","/manager-fe/assets/AuditLeaveDialog.5a4f6d6e.js","/manager-fe/assets/vendor.9586058d.js"]),"../views/apply/Leave.vue":()=>T((()=>import("./Leave.a62e76ac.js")),["/manager-fe/assets/Leave.a62e76ac.js","/manager-fe/assets/Audit.3de94bf5.css","/manager-fe/assets/OperateLeaveDialog.8f549b01.js","/manager-fe/assets/vendor.9586058d.js","/manager-fe/assets/AuditLeaveDialog.5a4f6d6e.js"]),"../views/dept/Dept.vue":()=>T((()=>import("./Dept.6d320830.js")),["/manager-fe/assets/Dept.6d320830.js","/manager-fe/assets/DeptOperateDialog.d4ff9255.js","/manager-fe/assets/vendor.9586058d.js"]),"../views/login/Login.vue":()=>T((()=>Promise.resolve().then((function(){return S}))),void 0),"../views/menu/Menu.vue":()=>T((()=>import("./Menu.1ae1a239.js")),["/manager-fe/assets/Menu.1ae1a239.js","/manager-fe/assets/MenuOperateDialog.0c544116.js","/manager-fe/assets/vendor.9586058d.js"]),"../views/role/Role.vue":()=>T((()=>import("./Role.1041b3f8.js")),["/manager-fe/assets/Role.1041b3f8.js","/manager-fe/assets/RoleOperateDialog.40516fd8.js","/manager-fe/assets/vendor.9586058d.js"]),"../views/users/Users.vue":()=>T((()=>import("./Users.ef0e15a0.js")),["/manager-fe/assets/Users.ef0e15a0.js","/manager-fe/assets/UserOperateDialog.b8ac66e1.js","/manager-fe/assets/vendor.9586058d.js"]),"../views/welcome/Welcome.vue":()=>T((()=>import("./Welcome.f2aa95ac.js")),["/manager-fe/assets/Welcome.f2aa95ac.js","/manager-fe/assets/Welcome.0f78db55.css","/manager-fe/assets/vendor.9586058d.js"]),"../views/apply/components/AuditLeaveDialog.vue":()=>T((()=>import("./AuditLeaveDialog.5a4f6d6e.js")),["/manager-fe/assets/AuditLeaveDialog.5a4f6d6e.js","/manager-fe/assets/vendor.9586058d.js"]),"../views/apply/components/OperateLeaveDialog.vue":()=>T((()=>import("./OperateLeaveDialog.8f549b01.js")),["/manager-fe/assets/OperateLeaveDialog.8f549b01.js","/manager-fe/assets/vendor.9586058d.js"]),"../views/dept/components/DeptOperateDialog.vue":()=>T((()=>import("./DeptOperateDialog.d4ff9255.js")),["/manager-fe/assets/DeptOperateDialog.d4ff9255.js","/manager-fe/assets/vendor.9586058d.js"]),"../views/menu/components/MenuOperateDialog.vue":()=>T((()=>import("./MenuOperateDialog.0c544116.js")),["/manager-fe/assets/MenuOperateDialog.0c544116.js","/manager-fe/assets/vendor.9586058d.js"]),"../views/role/components/RoleOperateDialog.vue":()=>T((()=>import("./RoleOperateDialog.40516fd8.js")),["/manager-fe/assets/RoleOperateDialog.40516fd8.js","/manager-fe/assets/vendor.9586058d.js"]),"../views/users/components/UserOperateDialog.vue":()=>T((()=>import("./UserOperateDialog.b8ac66e1.js")),["/manager-fe/assets/UserOperateDialog.b8ac66e1.js","/manager-fe/assets/vendor.9586058d.js"])};t.forEach((e=>{var t;if((e.path||e.menuName)&&1===e.menuType){if(0===o.filter((t=>t.path===e.path||t.name===e.menuName)).length){let o,s=((null==(t=e.component)?void 0:t.match(/\/([^/.]+)$/))||e.path.match(/\/(\w+)$/))[1];s&&(s=s.replace(/^\w/,(e=>e.toUpperCase())),e.component&&(o="",o=e.component.replace(/(.*)(views|components)\//,"../$2/"),o=/(\.\w+)$/.test(o)?o:`${o}.vue`),se.addRoute("Home",{name:s,path:e.path,meta:{title:e.menuName},component:r[o]}))}}}))};ne();const ae=I.create({baseURL:X.mockAPI,timeout:8e3});function ie(e){const t=e||{};return t.method=String(t.method||"get").toLocaleLowerCase(),"get"!==t.method||t.params||(t.params=t.data),t.isMock&&"production"!==X.env&&(t.baseURL=X.mockAPI),ae(t)}["get","post","put","delete","patch"].forEach((e=>{ie[e]=(t,o,r={})=>(r.method=e,ie(i({url:t,data:o},r)))}));const le=30001,ue=50001,ce={10001:"缺少参数，或参数不合法！",20001:"账号或密码错误！",30001:"用户未登录，请先登录",40001:"业务请求失败",50001:"认证失效，请重新登录！"};ae.interceptors.request.use((e=>{const{token:t}=te.state.userInfo;return e.headers.Authorization=`Bearer ${t}`,e}),(e=>{O.error(e.message)})),ae.interceptors.response.use((e=>{if(200===e.status||304===e.status)if(void 0!==e.data){const t=e.data;if(200===t.code&&void 0!==t.data)return t.data;!t||t.code!==ue&&t.code!==le||setTimeout((()=>{te.commit("logout"),se.push({name:"Login"})}),2e3),O.error(t.msg||ce[t.code]||"返回数据格式有误！")}else O.error("没有返回信息！");else O.error("网络请求异常，请稍后重试!");return e}),(e=>{O.error(e.message)}));var me={async login(e,t){let o={};try{e&&t?o=await ie.post("/user/login",{userName:e,userPwd:t}):O.warning("请填写用户名和密码")}catch(r){console.error(r),O.error("登录出错！")}return o},async getNoticeCount(){let e=0;try{e=await ie.get("/leave/count"),te.commit("saveNoticeCount",e)}catch(t){console.error(t),O.error("查询通知出错！")}return e},async getPermissionList(){let e={};try{e=await ie.get("/menu/permissionList"),te.commit("savePermissionList",e)}catch(t){console.error(t),O.error("加载权限菜单出错！")}return e},async getUserList(e){let t={};try{t=await ie.get("/user/list",e)}catch(o){console.error(o),O.error("获取用户列表出错！")}return t},async userDel(e){let t=0;try{const o=await ie.post("/user/delete",e);o&&o.nModified>0&&(t=o.nModified)}catch(o){console.error(o),O.error("删除用户出错！")}return t},async userOperate(e){let t=!1;try{const o=await ie.post("/user/operate",e);o&&(o.nModified>0||o._id)&&(t=!0)}catch(o){console.error(o),O.error(`${e.title}出错！`)}return t},async getRoleAllList(){let e=[];try{e=await ie.get("/role/alllist")}catch(t){console.error(t),O.error("获取系统角色列表出错！")}return e},async getDeptList(e){let t=[];try{t=await ie.get("/dept/list",e)}catch(o){console.error(o),O.error("获取部门列表出错！")}return t},async getMenuList(e){let t=[];try{t=await ie.get("/menu/list",e)}catch(o){console.error(o),O.error("获取菜单列表出错！")}return t},async menuOperate(e){let t=!1;try{const o=await ie.post("/menu/operate",e);o&&(o.deletedCount>0||o.nModified>0||o._id)&&(t=!0)}catch(o){console.error(o),O.error(`${e.title}出错！`)}return t},async getRoleList(e){let t=[];try{t=await ie.get("/role/list",e)}catch(o){console.error(o),O.error("获取系统角色列表出错！")}return t},async roleOperate(e){let t=!1;try{const o=await ie.post("/role/operate",e);o&&(o.deletedCount>0||o.nModified>0||o._id)&&(t=!0)}catch(o){console.error(o),O.error(`${e.title}出错！`)}return t},async deptOperate(e){let t=!1;try{const o=await ie.post("/dept/operate",e);o&&(o.deletedCount>0||o.nModified>0||o._id)&&(t=!0)}catch(o){console.error(o),O.error(`${e.title}出错！`)}return t},async getLeaveList(e){let t=[];try{t=await ie.get("/leave/list",e)}catch(o){console.error(o),O.error("获取休假申请列表出错！")}return t},async leaveOperate(e){let t=!1;try{const o=await ie.post("/leave/operate",e);o&&(o.deletedCount>0||o.nModified>0||o._id)&&(t=!0)}catch(o){console.error(o),O.error(`${e.title}申请休假出错！`)}return t},async leaveAudit(e){let t=!1;try{const o=await ie.post("/leave/audit",e);o&&(o.deletedCount>0||o.nModified>0||o._id)&&(t=!0)}catch(o){console.error(o),O.error(`${e.title}申请休假出错！`)}return t}},de={mounted:(e,t)=>{try{t.value&&te.getters.permissionBtnCodeList&&te.getters.permissionBtnCodeList.indexOf(t.value)>-1||(e.style.display="none",E((()=>{e.parentNode.removeChild(e)})))}catch(o){console.error(o)}}};const pe={};pe.render=function(e,t){const o=u("router-view");return c(),m(o)};const ge=D(pe);ge.config.globalProperties.$requset=ie,ge.config.globalProperties.$api=me,ge.use(P,{size:"small"}),ge.use(se),ge.use(te),ge.directive("has",de),ge.mount("#app");export{oe as u};
