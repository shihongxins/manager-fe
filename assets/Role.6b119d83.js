var e=Object.defineProperty,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,r=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,o=(e,o)=>{for(var i in o||(o={}))l.call(o,i)&&r(e,i,o[i]);if(a)for(var i of a(o))t.call(o,i)&&r(e,i,o[i]);return e};import{u as i}from"./index.03b6c02e.js";import n from"./RoleOperateDialog.40516fd8.js";import{u as s,s as p,v as u,r as m,x as d,o as c,c as g,a as f,w as b,y,F as h,d as _,z as D,b as w}from"./vendor.9586058d.js";const z=e=>{const a=[{label:"角色名称",prop:"roleName"},{label:"备注",prop:"remark"},{label:"权限列表",prop:"rolePermission",formatter(e,a,l){const t=(e=[],a,l=[])=>{e.forEach((e=>{a.indexOf(e._id)>-1&&l.push(e.menuName),e.children&&e.children.length&&t(e.children,a,l)}))},r=[];return l&&l.checkedPages&&t(m.value,l.checkedPages,r),r.join(",").replace(/,$/,"")}},{label:"更新时间",prop:"updateTime",formatter:(e,a,l)=>i.formatterDateTime(l),width:90}],l=s([]),t=p({roleName:""}),r=p({pageNum:1,pageSize:10,total:0}),n=async()=>{const a=o(o({},r),t),{page:i,list:n}=await e.$api.getRoleList(a);i&&n&&(l.value=n,r.total=i.total)},m=s([]);return u((()=>{n(),(async()=>{const a=await e.$api.getMenuList();a&&(m.value=a)})()})),{tableColumns:a,roleList:l,query:t,pageData:r,menuList:m,getRoleList:n,handleQuerySubmit:a=>{const{reset:l,pageNum:t,pageSize:o}=a;l&&e.$refs.queryForm.resetFields(),r.pageNum=t||1,r.pageSize=o||10,n()},showDialog:(a,l,t)=>{e.$refs.roleOperateDialog.handleToggleDialogShow(a,l,t)},handleSingleDel:async a=>{if(a&&a._id){!0===await e.$api.roleOperate({_id:a._id,roleName:a.roleName,action:"delete"})?(e.$message.success("删除成功！"),n()):e.$message.error("删除失败！")}}}},S={name:"Role",components:{RoleOperateDialog:n},setup(){const{ctx:e}=D();return o({},z(e))}},k={class:"content_wrapper"},v={class:"query_form_wrapper"},C=w("查询"),N=w(" 重置 "),O={class:"table_container"},L={class:"table_tools"},j=w(" 新增 "),R={class:"table_content"},P=w("编辑"),$=w("设置权限"),q=w("删除");S.render=function(e,a,l,t,r,o){const i=m("el-input"),n=m("el-form-item"),s=m("el-button"),p=m("el-form"),u=m("el-table-column"),D=m("el-table"),w=m("el-pagination"),z=m("RoleOperateDialog"),S=d("has");return c(),g("div",k,[f("div",v,[f(p,{inline:!0,model:e.query,ref:"queryForm"},{default:b((()=>[f(n,{label:"角色名称",prop:"roleName"},{default:b((()=>[f(i,{modelValue:e.query.roleName,"onUpdate:modelValue":a[1]||(a[1]=a=>e.query.roleName=a),placeholder:"请输入角色名称"},null,8,["modelValue"])])),_:1}),f(n,null,{default:b((()=>[f(s,{type:"primary",onClick:e.handleQuerySubmit},{default:b((()=>[C])),_:1},8,["onClick"]),f(s,{onClick:a[2]||(a[2]=a=>e.handleQuerySubmit({reset:!0}))},{default:b((()=>[N])),_:1})])),_:1})])),_:1},8,["model"])]),f("div",O,[f("div",L,[y(f(s,{type:"primary",onClick:a[3]||(a[3]=a=>e.showDialog(!0,"add"))},{default:b((()=>[j])),_:1},512),[[S,"role-add"]])]),f("div",R,[f(D,{data:e.roleList,stripe:""},{default:b((()=>[(c(!0),g(h,null,_(e.tableColumns,(e=>(c(),g(u,{key:e.prop,prop:e.prop,label:e.label,formatter:e.formatter},null,8,["prop","label","formatter"])))),128)),f(u,{label:"操作"},{default:b((a=>[y(f(s,{size:"mini",onClick:l=>e.showDialog(!0,"edit",a.row)},{default:b((()=>[P])),_:2},1032,["onClick"]),[[S,"role-edit"]]),y(f(s,{size:"mini",type:"primary",onClick:l=>e.showDialog(!0,"setPermission",a.row)},{default:b((()=>[$])),_:2},1032,["onClick"]),[[S,"role-setPermission"]]),y(f(s,{size:"mini",type:"danger",onClick:l=>e.handleSingleDel(a.row)},{default:b((()=>[q])),_:2},1032,["onClick"]),[[S,"role-delete"]])])),_:1})])),_:1},8,["data"]),f(w,{onSizeChange:a[4]||(a[4]=a=>{e.handleQuerySubmit({pageSize:a})}),onCurrentChange:a[5]||(a[5]=a=>{e.handleQuerySubmit({pageNum:a})}),"current-page":e.pageData.pageNum,"onUpdate:current-page":a[6]||(a[6]=a=>e.pageData.pageNum=a),"page-sizes":[10,20,50,100],"page-size":e.pageData.pageSize,"onUpdate:page-size":a[7]||(a[7]=a=>e.pageData.pageSize=a),total:e.pageData.total,class:"table_pagination",layout:"total, sizes, prev, pager, next, jumper",background:""},null,8,["current-page","page-size","total"])])]),f(z,{ref:"roleOperateDialog",getRoleList:e.getRoleList,menuList:e.menuList},null,8,["getRoleList","menuList"])])};export default S;
