var e=Object.defineProperty,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,t=(a,l,o)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[l]=o;import{s as r,B as i,z as s,r as d,o as n,c,w as m,a as u,y as p,D as g,F as h,e as f,b as k}from"./vendor.9586058d.js";const D={name:"RoleOperateDialog",props:{getRoleList:{required:!0,type:Function},menuList:{type:Array,default:()=>[]}},setup(e){const{ctx:d}=s();return((e,r)=>{for(var i in r||(r={}))l.call(r,i)&&t(e,i,r[i]);if(a)for(var i of a(r))o.call(r,i)&&t(e,i,r[i]);return e})({},((e,a)=>{const l=r({_id:"",roleName:"",remark:"",checkedPages:[],checkedBtns:[],action:"add",title:"新增角色",showDialog:!1}),o=(a,o,t)=>{o&&(l.action=o),"edit"===o?l.title="编辑角色":"add"===o?l.title="新增角色":"setPermission"===o&&(l.title="设置权限"),l.showDialog=a,e.$nextTick((()=>{if(e.$refs.operateForm.resetFields(),void 0!==t&&("edit"===o||"setPermission"===o)&&(l._id=t._id,l.roleName=t.roleName,l.remark=t.remark,"setPermission"===o)){if(t.rolePermission){const{checkedPages:e,checkedBtns:a}=t.rolePermission;l.checkedPages=e,l.checkedBtns=a}[...l.checkedPages,...l.checkedBtns].forEach((a=>{e.$refs.menuTree.setChecked(a,!0,!1)}))}}))};return{dialogData:l,dialogDataRules:{roleName:{trigger:"blur",required:!0,message:"请输入角色名称"}},handleToggleDialogShow:o,handleSubmitRoleOperate:()=>{e.$refs.operateForm.validate((async t=>{if(t){const t=i(l);if("setPermission"!==t.action)delete t.checkedPages,delete t.checkedBtns;else{const a=e.$refs.menuTree.getCheckedNodes(!1,!0),l=[],o=[];a.forEach((e=>{e&&(1===e.menuType&&l.push(e._id),2===e.menuType&&o.push(e._id))})),t.rolePermission={checkedPages:l,checkedBtns:o}}!0===await e.$api.roleOperate(t)?(o(!1),a(),e.$message.success(`${l.title} -> [${t.roleName}] 成功！`)):e.$message.warning(`${l.title} -> [${t.roleName}] 失败！`)}}))}}})(d,e.getRoleList))}},b=k("取 消"),y=k("确 定");D.render=function(e,a,l,o,t,r){const i=d("el-input"),s=d("el-form-item"),k=d("el-divider"),D=d("el-tree"),P=d("el-form"),w=d("el-button"),$=d("el-dialog");return n(),c($,{modelValue:e.dialogData.showDialog,"onUpdate:modelValue":a[4]||(a[4]=a=>e.dialogData.showDialog=a),title:e.dialogData.title},{footer:m((()=>[u(w,{onClick:a[3]||(a[3]=a=>e.handleToggleDialogShow(!1))},{default:m((()=>[b])),_:1}),u(w,{type:"primary",onClick:e.handleSubmitRoleOperate},{default:m((()=>[y])),_:1},8,["onClick"])])),default:m((()=>[u(P,{model:e.dialogData,rules:e.dialogDataRules,ref:"operateForm","label-position":"right","label-width":"6em"},{default:m((()=>[u(s,{label:"角色名称",prop:"roleName"},{default:m((()=>[u(i,{modelValue:e.dialogData.roleName,"onUpdate:modelValue":a[1]||(a[1]=a=>e.dialogData.roleName=a),placeholder:"请输入角色名称",autocomplete:"off",disabled:"setPermission"===e.dialogData.action},null,8,["modelValue","disabled"])])),_:1}),p(u(s,{label:"备注",prop:"remark"},{default:m((()=>[u(i,{type:"textarea",modelValue:e.dialogData.remark,"onUpdate:modelValue":a[2]||(a[2]=a=>e.dialogData.remark=a),placeholder:"请输入备注信息",autocomplete:"off"},null,8,["modelValue"])])),_:1},512),[[g,"setPermission"!=e.dialogData.action]]),"setPermission"===e.dialogData.action&&e.dialogData.showDialog?(n(),c(h,{key:0},[u(k),u(D,{ref:"menuTree","show-checkbox":"","default-expand-all":"","node-key":"_id",data:l.menuList,props:{children:"children",label:"menuName"}},null,8,["data"])],64)):f("",!0)])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])};export default D;
