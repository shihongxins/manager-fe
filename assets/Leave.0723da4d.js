var e=Object.defineProperty,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,r=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,o=(e,o)=>{for(var i in o||(o={}))l.call(o,i)&&r(e,i,o[i]);if(a)for(var i of a(o))t.call(o,i)&&r(e,i,o[i]);return e};import{u as i}from"./index.03b6c02e.js";import p from"./OperateLeaveDialog.ac21cab4.js";import s from"./AuditLeaveDialog.5a4f6d6e.js";import{s as n,u,v as d,r as v,x as g,o as m,c as b,a as c,w as y,F as f,d as L,y as w,e as h,z as S,b as D}from"./vendor.9586058d.js";const _={name:"Leave",components:{OperateLeaveDialog:p,AuditLeaveDialog:s},setup(){const{ctx:e}=S();return o({},(e=>{const a=[{label:"申请单号",prop:"applyNO",width:120},{label:"申请时间",prop:"createTime",width:90,formatter:(e,a,l)=>i.formatterDateTime(l)},{label:"休假类型",prop:"leaveType",width:70,formatter(e,a,t){var r;return null==(r=l.filter((e=>e.value===t))[0])?void 0:r.label}},{label:"休假时间",prop:"leaveDate",width:150,formatter:(e,a,l)=>l.join("至 ")},{label:"休假时长",prop:"leaveLength",width:90,formatter:(e,a,l)=>`${l} 天`},{label:"休假原因",prop:"reason",className:"leave-reason"},{label:"审批流程",prop:"auditFlows",formatter:(e,a,l)=>l.map((e=>e.userName)).join(" -> ")},{label:"当前进度",prop:"currentFlowUser",width:70,formatter:(e,a,l)=>l.userName},{label:"申请状态",prop:"applyState",width:70,formatter:(e,a,l)=>t.filter((e=>e.value===l))[0].label}],l=n([{label:"事假",value:1},{label:"调休",value:2},{label:"年假",value:3}]),t=n([{label:"全部",value:0},{label:"待审批",value:1},{label:"审批中",value:2},{label:"审批通过",value:3},{label:"审批驳回",value:4},{label:"撤销作废",value:5}]),r=u([]),p=n({applyState:0,type:"apply"}),s=n({pageNum:1,pageSize:10,total:0}),v=async()=>{const a=o(o({},s),p),{page:l,list:t}=await e.$api.getLeaveList(a);l&&t&&(r.value=t,s.total=l.total)};return d((()=>{v()})),{tableColumns:a,leaveTypeList:l,applyStateList:t,leaveList:r,query:p,pageData:s,getLeaveList:v,handleQuerySubmit:a=>{const{reset:l,pageNum:t,pageSize:r}=a;l&&e.$refs.queryForm.resetFields(),s.pageNum=t||1,s.pageSize=r||10,v()},showOperateLeaveDialog:a=>{e.$refs.operateLeaveDialog.handleToggleDialogShow(a)},showAuditLeaveDialog:(a,l,t)=>{e.$refs.auditLeaveDialog.handleToggleDialogShow(a,l,t)},handleSingleDel:async a=>{a&&a._id&&(!0===await e.$api.leaveOperate({_id:a._id,action:"delete",title:"撤销并作废休假申请"})?(e.$message.success("作废撤销成功！"),v()):e.$message.error("作废撤销失败！"))}}})(e))}},z={class:"content_wrapper"},O={class:"query_form_wrapper"},k=D("查询"),C=D(" 重置 "),T={class:"table_container"},j={class:"table_tools"},N=D(" 申请休假 "),$={class:"table_content"},q=D(" 查看 "),x=D(" 作废 ");_.render=function(e,a,l,t,r,o){const i=v("el-option"),p=v("el-select"),s=v("el-form-item"),n=v("el-button"),u=v("el-form"),d=v("el-table-column"),S=v("el-table"),D=v("el-pagination"),_=v("OperateLeaveDialog"),F=v("AuditLeaveDialog"),A=g("has");return m(),b("div",z,[c("div",O,[c(u,{inline:!0,model:e.query,ref:"queryForm"},{default:y((()=>[c(s,{label:"申请状态",prop:"applyState"},{default:y((()=>[c(p,{modelValue:e.query.applyState,"onUpdate:modelValue":a[1]||(a[1]=a=>e.query.applyState=a),placeholder:"请选择"},{default:y((()=>[(m(!0),b(f,null,L(e.applyStateList,(e=>(m(),b(i,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),c(s,null,{default:y((()=>[c(n,{type:"primary",onClick:e.handleQuerySubmit},{default:y((()=>[k])),_:1},8,["onClick"]),c(n,{onClick:a[2]||(a[2]=a=>e.handleQuerySubmit({reset:!0}))},{default:y((()=>[C])),_:1})])),_:1})])),_:1},8,["model"])]),c("div",T,[c("div",j,[w(c(n,{type:"primary",onClick:a[3]||(a[3]=a=>e.showOperateLeaveDialog(!0,"add"))},{default:y((()=>[N])),_:1},512),[[A,"leave-add"]])]),c("div",$,[c(S,{data:e.leaveList,"row-key":"_id",stripe:""},{default:y((()=>[(m(!0),b(f,null,L(e.tableColumns,(e=>(m(),b(d,{key:e.prop,prop:e.prop,label:e.label,width:e.width,formatter:e.formatter,"class-name":e.className},null,8,["prop","label","width","formatter","class-name"])))),128)),c(d,{label:"操作",width:"150px"},{default:y((a=>[w(c(n,{size:"mini",onClick:l=>e.showAuditLeaveDialog(!0,"view",a.row)},{default:y((()=>[q])),_:2},1032,["onClick"]),[[A,"leave-view"]]),[1,2].indexOf(a.row.applyState)>-1?w((m(),b(n,{key:0,size:"mini",type:"danger",onClick:l=>e.handleSingleDel(a.row)},{default:y((()=>[x])),_:2},1032,["onClick"])),[[A,"leave-delete"]]):h("",!0)])),_:1})])),_:1},8,["data"]),c(D,{onSizeChange:a[4]||(a[4]=a=>{e.handleQuerySubmit({pageSize:a})}),onCurrentChange:a[5]||(a[5]=a=>{e.handleQuerySubmit({pageNum:a})}),"current-page":e.pageData.pageNum,"onUpdate:current-page":a[6]||(a[6]=a=>e.pageData.pageNum=a),"page-sizes":[10,20,50,100],"page-size":e.pageData.pageSize,"onUpdate:page-size":a[7]||(a[7]=a=>e.pageData.pageSize=a),total:e.pageData.total,class:"table_pagination",layout:"total, sizes, prev, pager, next, jumper",background:""},null,8,["current-page","page-size","total"])])]),c(_,{ref:"operateLeaveDialog",getLeaveList:e.getLeaveList,leaveTypeList:e.leaveTypeList},null,8,["getLeaveList","leaveTypeList"]),c(F,{ref:"auditLeaveDialog",getLeaveList:e.getLeaveList,leaveTypeList:e.leaveTypeList,applyStateList:e.applyStateList},null,8,["getLeaveList","leaveTypeList","applyStateList"])])};export default _;
