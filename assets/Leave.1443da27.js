var e=Object.defineProperty,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,r=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,o=(e,o)=>{for(var i in o||(o={}))l.call(o,i)&&r(e,i,o[i]);if(a)for(var i of a(o))t.call(o,i)&&r(e,i,o[i]);return e};import{u as i}from"./index.a8eae04d.js";import p from"./OperateLeaveDialog.8af8e1c3.js";import s from"./AuditLeaveDialog.6c7c9410.js";import{s as n,u,v as d,x as v,r as g,y as m,o as y,c,a as b,w as f,F as L,d as w,z as h,e as S,A as D,b as _}from"./vendor.7002d699.js";const z={name:"Leave",components:{OperateLeaveDialog:p,AuditLeaveDialog:s},setup(){const{proxy:e}=D();return o({},(e=>{const a=n("$api"),l=[{label:"申请单号",prop:"applyNO",width:120},{label:"申请时间",prop:"createTime",width:90,formatter:(e,a,l)=>i.formatterDateTime(l)},{label:"休假类型",prop:"leaveType",width:70,formatter(e,a,l){var r;return null==(r=t.filter((e=>e.value===l))[0])?void 0:r.label}},{label:"休假时间",prop:"leaveDate",width:150,formatter:(e,a,l)=>l.join("至 ")},{label:"休假时长",prop:"leaveLength",width:90,formatter:(e,a,l)=>`${l} 天`},{label:"休假原因",prop:"reason",className:"leave-reason"},{label:"审批流程",prop:"auditFlows",formatter:(e,a,l)=>l.map((e=>e.userName)).join(" -> ")},{label:"当前进度",prop:"currentFlowUser",width:70,formatter:(e,a,l)=>l.userName},{label:"申请状态",prop:"applyState",width:70,formatter:(e,a,l)=>r.filter((e=>e.value===l))[0].label}],t=u([{label:"事假",value:1},{label:"调休",value:2},{label:"年假",value:3}]),r=u([{label:"全部",value:0},{label:"待审批",value:1},{label:"审批中",value:2},{label:"审批通过",value:3},{label:"审批驳回",value:4},{label:"撤销作废",value:5}]),p=d([]),s=u({applyState:0,type:"apply"}),g=u({pageNum:1,pageSize:10,total:0}),m=async()=>{const e=o(o({},g),s),{page:l,list:t}=await a.getLeaveList(e);l&&t&&(p.value=t,g.total=l.total)};return v((()=>{m()})),{tableColumns:l,leaveTypeList:t,applyStateList:r,leaveList:p,query:s,pageData:g,getLeaveList:m,handleQuerySubmit:a=>{const{reset:l,pageNum:t,pageSize:r}=a;l&&e.$refs.queryForm.resetFields(),g.pageNum=t||1,g.pageSize=r||10,m()},showOperateLeaveDialog:a=>{e.$refs.operateLeaveDialog.handleToggleDialogShow(a)},showAuditLeaveDialog:(a,l,t)=>{e.$refs.auditLeaveDialog.handleToggleDialogShow(a,l,t)},handleSingleDel:async l=>{l&&l._id&&(!0===await a.leaveOperate({_id:l._id,action:"delete",title:"撤销并作废休假申请"})?(e.$message.success("作废撤销成功！"),m()):e.$message.error("作废撤销失败！"))}}})(e))}},O={class:"content_wrapper"},k={class:"query_form_wrapper"},C=_("查询"),T=_(" 重置 "),j={class:"table_container"},N={class:"table_tools"},q=_(" 申请休假 "),x={class:"table_content"},$=_(" 查看 "),A=_(" 作废 ");z.render=function(e,a,l,t,r,o){const i=g("el-option"),p=g("el-select"),s=g("el-form-item"),n=g("el-button"),u=g("el-form"),d=g("el-table-column"),v=g("el-table"),D=g("el-pagination"),_=g("OperateLeaveDialog"),z=g("AuditLeaveDialog"),F=m("has");return y(),c("div",O,[b("div",k,[b(u,{inline:!0,model:e.query,ref:"queryForm"},{default:f((()=>[b(s,{label:"申请状态",prop:"applyState"},{default:f((()=>[b(p,{modelValue:e.query.applyState,"onUpdate:modelValue":a[1]||(a[1]=a=>e.query.applyState=a),placeholder:"请选择"},{default:f((()=>[(y(!0),c(L,null,w(e.applyStateList,(e=>(y(),c(i,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),b(s,null,{default:f((()=>[b(n,{type:"primary",onClick:e.handleQuerySubmit},{default:f((()=>[C])),_:1},8,["onClick"]),b(n,{onClick:a[2]||(a[2]=a=>e.handleQuerySubmit({reset:!0}))},{default:f((()=>[T])),_:1})])),_:1})])),_:1},8,["model"])]),b("div",j,[b("div",N,[h(b(n,{type:"primary",onClick:a[3]||(a[3]=a=>e.showOperateLeaveDialog(!0,"add"))},{default:f((()=>[q])),_:1},512),[[F,"leave-add"]])]),b("div",x,[b(v,{data:e.leaveList,"row-key":"_id",stripe:""},{default:f((()=>[(y(!0),c(L,null,w(e.tableColumns,(e=>(y(),c(d,{key:e.prop,prop:e.prop,label:e.label,width:e.width,formatter:e.formatter,"class-name":e.className},null,8,["prop","label","width","formatter","class-name"])))),128)),b(d,{label:"操作",width:"150px"},{default:f((a=>[h(b(n,{size:"mini",onClick:l=>e.showAuditLeaveDialog(!0,"view",a.row)},{default:f((()=>[$])),_:2},1032,["onClick"]),[[F,"leave-view"]]),[1,2].indexOf(a.row.applyState)>-1?h((y(),c(n,{key:0,size:"mini",type:"danger",onClick:l=>e.handleSingleDel(a.row)},{default:f((()=>[A])),_:2},1032,["onClick"])),[[F,"leave-delete"]]):S("",!0)])),_:1})])),_:1},8,["data"]),b(D,{onSizeChange:a[4]||(a[4]=a=>{e.handleQuerySubmit({pageSize:a})}),onCurrentChange:a[5]||(a[5]=a=>{e.handleQuerySubmit({pageNum:a})}),"current-page":e.pageData.pageNum,"onUpdate:current-page":a[6]||(a[6]=a=>e.pageData.pageNum=a),"page-sizes":[10,20,50,100],"page-size":e.pageData.pageSize,"onUpdate:page-size":a[7]||(a[7]=a=>e.pageData.pageSize=a),total:e.pageData.total,class:"table_pagination",layout:"total, sizes, prev, pager, next, jumper",background:""},null,8,["current-page","page-size","total"])])]),b(_,{ref:"operateLeaveDialog",getLeaveList:e.getLeaveList,leaveTypeList:e.leaveTypeList},null,8,["getLeaveList","leaveTypeList"]),b(z,{ref:"auditLeaveDialog",getLeaveList:e.getLeaveList,leaveTypeList:e.leaveTypeList,applyStateList:e.applyStateList},null,8,["getLeaveList","leaveTypeList","applyStateList"])])};export default z;
