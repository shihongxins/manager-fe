var e=Object.defineProperty,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,r=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,o=(e,o)=>{for(var i in o||(o={}))l.call(o,i)&&r(e,i,o[i]);if(a)for(var i of a(o))t.call(o,i)&&r(e,i,o[i]);return e};import{u as i}from"./index.03b6c02e.js";import p from"./AuditLeaveDialog.5a4f6d6e.js";import{s as u,u as s,v as n,r as d,x as m,o as v,c as b,a as g,w as y,F as c,d as f,y as w,z as L,b as h}from"./vendor.9586058d.js";const S={name:"Audit",components:{AuditLeaveDialog:p},setup(){const{ctx:e}=L();return o({},(e=>{const a=[{label:"申请单号",prop:"applyNO",width:120},{label:"申请人",prop:"applyUser",formatter:(e,a,l)=>l.userName},{label:"申请时间",prop:"createTime",width:90,formatter:(e,a,l)=>i.formatterDateTime(l)},{label:"休假类型",prop:"leaveType",width:70,formatter(e,a,t){var r;return null==(r=l.filter((e=>e.value===t))[0])?void 0:r.label}},{label:"休假时间",prop:"leaveDate",width:150,formatter:(e,a,l)=>l.join("至 ")},{label:"休假时长",prop:"leaveLength",width:90,formatter:(e,a,l)=>`${l} 天`},{label:"休假原因",prop:"reason",className:"leave-reason"},{label:"审批流程",prop:"auditFlows",formatter:(e,a,l)=>l.map((e=>e.userName)).join(" -> ")},{label:"当前进度",prop:"currentFlowUser",width:70,formatter:(e,a,l)=>l.userName},{label:"审批状态",prop:"applyState",width:70,formatter(e,a,l){var r;return null==(r=t.filter((e=>e.value===l))[0])?void 0:r.label}}],l=u([{label:"事假",value:1},{label:"调休",value:2},{label:"年假",value:3}]),t=u([{label:"全部",value:0},{label:"待审批",value:1},{label:"审批中",value:2},{label:"审批通过",value:3},{label:"审批驳回",value:4},{label:"撤销作废",value:5}]),r=s([]),p=u({applyState:1,type:"audit"}),d=u({pageNum:1,pageSize:10,total:0}),m=async()=>{const a=o(o({},d),p),{page:l,list:t}=await e.$api.getLeaveList(a);l&&t&&(r.value=t,d.total=l.total)};return n((()=>{m()})),{tableColumns:a,leaveTypeList:l,applyStateList:t,leaveList:r,query:p,pageData:d,getLeaveList:m,handleQuerySubmit:a=>{const{reset:l,pageNum:t,pageSize:r}=a;l&&e.$refs.queryForm.resetFields(),d.pageNum=t||1,d.pageSize=r||10,m()},showAuditLeaveDialog:(a,l,t)=>{e.$refs.auditLeaveDialog.handleToggleDialogShow(a,l,t)},editable:a=>{var l,t;return a&&[1,2].indexOf(a.applyState)>-1&&(null==(l=a.currentFlowUser)?void 0:l.userId)===(null==(t=e.$store.state.userInfo)?void 0:t.userId)}}})(e))}},D={class:"content_wrapper"},_={class:"query_form_wrapper"},z=h("查询"),k=h(" 重置 "),C={class:"table_container"},N={class:"table_content"},j=h(" 审核 "),O=h(" 查看 ");S.render=function(e,a,l,t,r,o){const i=d("el-option"),p=d("el-select"),u=d("el-form-item"),s=d("el-button"),n=d("el-form"),L=d("el-table-column"),h=d("el-table"),S=d("el-pagination"),T=d("AuditLeaveDialog"),q=m("has");return v(),b("div",D,[g("div",_,[g(n,{inline:!0,model:e.query,ref:"queryForm"},{default:y((()=>[g(u,{label:"申请状态",prop:"applyState"},{default:y((()=>[g(p,{modelValue:e.query.applyState,"onUpdate:modelValue":a[1]||(a[1]=a=>e.query.applyState=a),placeholder:"请选择"},{default:y((()=>[(v(!0),b(c,null,f(e.applyStateList,(e=>(v(),b(i,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),g(u,null,{default:y((()=>[g(s,{type:"primary",onClick:e.handleQuerySubmit},{default:y((()=>[z])),_:1},8,["onClick"]),g(s,{onClick:a[2]||(a[2]=a=>e.handleQuerySubmit({reset:!0}))},{default:y((()=>[k])),_:1})])),_:1})])),_:1},8,["model"])]),g("div",C,[g("div",N,[g(h,{data:e.leaveList,"row-key":"_id",stripe:""},{default:y((()=>[(v(!0),b(c,null,f(e.tableColumns,(e=>(v(),b(L,{key:e.prop,prop:e.prop,label:e.label,width:e.width,formatter:e.formatter,"class-name":e.className},null,8,["prop","label","width","formatter","class-name"])))),128)),g(L,{label:"操作",width:"150px"},{default:y((a=>[e.editable(a.row)?w((v(),b(s,{key:0,type:"primary",size:"mini",onClick:l=>e.showAuditLeaveDialog(!0,"edit",a.row)},{default:y((()=>[j])),_:2},1032,["onClick"])),[[q,"leave-edit"]]):(v(),b(s,{key:1,size:"mini",onClick:l=>e.showAuditLeaveDialog(!0,"view",a.row)},{default:y((()=>[O])),_:2},1032,["onClick"]))])),_:1})])),_:1},8,["data"]),g(S,{onSizeChange:a[3]||(a[3]=a=>{e.handleQuerySubmit({pageSize:a})}),onCurrentChange:a[4]||(a[4]=a=>{e.handleQuerySubmit({pageNum:a})}),"current-page":e.pageData.pageNum,"onUpdate:current-page":a[5]||(a[5]=a=>e.pageData.pageNum=a),"page-sizes":[10,20,50,100],"page-size":e.pageData.pageSize,"onUpdate:page-size":a[6]||(a[6]=a=>e.pageData.pageSize=a),total:e.pageData.total,class:"table_pagination",layout:"total, sizes, prev, pager, next, jumper",background:""},null,8,["current-page","page-size","total"])])]),g(T,{ref:"auditLeaveDialog",getLeaveList:e.getLeaveList,leaveTypeList:e.leaveTypeList,applyStateList:e.applyStateList},null,8,["getLeaveList","leaveTypeList","applyStateList"])])};export default S;
