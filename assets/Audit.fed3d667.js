var e=Object.defineProperty,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,r=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,o=(e,o)=>{for(var p in o||(o={}))l.call(o,p)&&r(e,p,o[p]);if(a)for(var p of a(o))t.call(o,p)&&r(e,p,o[p]);return e};import{u as p}from"./index.a8eae04d.js";import i from"./AuditLeaveDialog.6c7c9410.js";import{s as u,u as s,v as n,x as d,r as m,y as v,o as b,c as g,a as y,w as c,F as f,d as w,z as L,A as h,b as S}from"./vendor.7002d699.js";const D={name:"Audit",components:{AuditLeaveDialog:i},setup(){const{proxy:e}=h();return o({},(e=>{const a=u("$api"),l=[{label:"申请单号",prop:"applyNO",width:120},{label:"申请人",prop:"applyUser",formatter:(e,a,l)=>l.userName},{label:"申请时间",prop:"createTime",width:90,formatter:(e,a,l)=>p.formatterDateTime(l)},{label:"休假类型",prop:"leaveType",width:70,formatter(e,a,l){var r;return null==(r=t.filter((e=>e.value===l))[0])?void 0:r.label}},{label:"休假时间",prop:"leaveDate",width:150,formatter:(e,a,l)=>l.join("至 ")},{label:"休假时长",prop:"leaveLength",width:90,formatter:(e,a,l)=>`${l} 天`},{label:"休假原因",prop:"reason",className:"leave-reason"},{label:"审批流程",prop:"auditFlows",formatter:(e,a,l)=>l.map((e=>e.userName)).join(" -> ")},{label:"当前进度",prop:"currentFlowUser",width:70,formatter:(e,a,l)=>l.userName},{label:"审批状态",prop:"applyState",width:70,formatter(e,a,l){var t;return null==(t=r.filter((e=>e.value===l))[0])?void 0:t.label}}],t=s([{label:"事假",value:1},{label:"调休",value:2},{label:"年假",value:3}]),r=s([{label:"全部",value:0},{label:"待审批",value:1},{label:"审批中",value:2},{label:"审批通过",value:3},{label:"审批驳回",value:4},{label:"撤销作废",value:5}]),i=n([]),m=s({applyState:1,type:"audit"}),v=s({pageNum:1,pageSize:10,total:0}),b=async()=>{const e=o(o({},v),m),{page:l,list:t}=await a.getLeaveList(e);l&&t&&(i.value=t,v.total=l.total)};return d((()=>{b()})),{tableColumns:l,leaveTypeList:t,applyStateList:r,leaveList:i,query:m,pageData:v,getLeaveList:b,handleQuerySubmit:a=>{const{reset:l,pageNum:t,pageSize:r}=a;l&&e.$refs.queryForm.resetFields(),v.pageNum=t||1,v.pageSize=r||10,b()},showAuditLeaveDialog:(a,l,t)=>{e.$refs.auditLeaveDialog.handleToggleDialogShow(a,l,t)},editable:a=>{var l,t;return a&&[1,2].indexOf(a.applyState)>-1&&(null==(l=a.currentFlowUser)?void 0:l.userId)===(null==(t=e.$store.state.userInfo)?void 0:t.userId)}}})(e))}},_={class:"content_wrapper"},z={class:"query_form_wrapper"},k=S("查询"),C=S(" 重置 "),N={class:"table_container"},j={class:"table_content"},A=S(" 审核 "),O=S(" 查看 ");D.render=function(e,a,l,t,r,o){const p=m("el-option"),i=m("el-select"),u=m("el-form-item"),s=m("el-button"),n=m("el-form"),d=m("el-table-column"),h=m("el-table"),S=m("el-pagination"),D=m("AuditLeaveDialog"),T=v("has");return b(),g("div",_,[y("div",z,[y(n,{inline:!0,model:e.query,ref:"queryForm"},{default:c((()=>[y(u,{label:"申请状态",prop:"applyState"},{default:c((()=>[y(i,{modelValue:e.query.applyState,"onUpdate:modelValue":a[1]||(a[1]=a=>e.query.applyState=a),placeholder:"请选择"},{default:c((()=>[(b(!0),g(f,null,w(e.applyStateList,(e=>(b(),g(p,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),y(u,null,{default:c((()=>[y(s,{type:"primary",onClick:e.handleQuerySubmit},{default:c((()=>[k])),_:1},8,["onClick"]),y(s,{onClick:a[2]||(a[2]=a=>e.handleQuerySubmit({reset:!0}))},{default:c((()=>[C])),_:1})])),_:1})])),_:1},8,["model"])]),y("div",N,[y("div",j,[y(h,{data:e.leaveList,"row-key":"_id",stripe:""},{default:c((()=>[(b(!0),g(f,null,w(e.tableColumns,(e=>(b(),g(d,{key:e.prop,prop:e.prop,label:e.label,width:e.width,formatter:e.formatter,"class-name":e.className},null,8,["prop","label","width","formatter","class-name"])))),128)),y(d,{label:"操作",width:"150px"},{default:c((a=>[e.editable(a.row)?L((b(),g(s,{key:0,type:"primary",size:"mini",onClick:l=>e.showAuditLeaveDialog(!0,"edit",a.row)},{default:c((()=>[A])),_:2},1032,["onClick"])),[[T,"leave-edit"]]):(b(),g(s,{key:1,size:"mini",onClick:l=>e.showAuditLeaveDialog(!0,"view",a.row)},{default:c((()=>[O])),_:2},1032,["onClick"]))])),_:1})])),_:1},8,["data"]),y(S,{onSizeChange:a[3]||(a[3]=a=>{e.handleQuerySubmit({pageSize:a})}),onCurrentChange:a[4]||(a[4]=a=>{e.handleQuerySubmit({pageNum:a})}),"current-page":e.pageData.pageNum,"onUpdate:current-page":a[5]||(a[5]=a=>e.pageData.pageNum=a),"page-sizes":[10,20,50,100],"page-size":e.pageData.pageSize,"onUpdate:page-size":a[6]||(a[6]=a=>e.pageData.pageSize=a),total:e.pageData.total,class:"table_pagination",layout:"total, sizes, prev, pager, next, jumper",background:""},null,8,["current-page","page-size","total"])])]),y(D,{ref:"auditLeaveDialog",getLeaveList:e.getLeaveList,leaveTypeList:e.leaveTypeList,applyStateList:e.applyStateList},null,8,["getLeaveList","leaveTypeList","applyStateList"])])};export default D;
