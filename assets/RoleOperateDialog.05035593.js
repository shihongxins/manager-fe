var e=Object.defineProperty,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,t=(a,l,o)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[l]=o;import{s as r,u as i,C as s,A as d,r as n,o as c,c as m,w as u,a as p,z as g,E as h,F as f,e as k,b as D}from"./vendor.7002d699.js";const b={name:"RoleOperateDialog",props:{getRoleList:{required:!0,type:Function},menuList:{type:Array,default:()=>[]}},setup(e){const{proxy:n}=d();return((e,r)=>{for(var i in r||(r={}))l.call(r,i)&&t(e,i,r[i]);if(a)for(var i of a(r))o.call(r,i)&&t(e,i,r[i]);return e})({},((e,a)=>{const l=r("$api"),o=i({_id:"",roleName:"",remark:"",checkedPages:[],checkedBtns:[],action:"add",title:"新增角色",showDialog:!1}),t=(a,l,t)=>{l&&(o.action=l),"edit"===l?o.title="编辑角色":"add"===l?o.title="新增角色":"setPermission"===l&&(o.title="设置权限"),o.showDialog=a,e.$nextTick((()=>{if(e.$refs.operateForm.resetFields(),void 0!==t&&("edit"===l||"setPermission"===l)&&(o._id=t._id,o.roleName=t.roleName,o.remark=t.remark,"setPermission"===l)){if(t.rolePermission){const{checkedPages:e,checkedBtns:a}=t.rolePermission;o.checkedPages=e,o.checkedBtns=a}[...o.checkedPages,...o.checkedBtns].forEach((a=>{e.$refs.menuTree.setChecked(a,!0,!1)}))}}))};return{dialogData:o,dialogDataRules:{roleName:{trigger:"blur",required:!0,message:"请输入角色名称"}},handleToggleDialogShow:t,handleSubmitRoleOperate:()=>{e.$refs.operateForm.validate((async r=>{if(r){const r=s(o);if("setPermission"!==r.action)delete r.checkedPages,delete r.checkedBtns;else{const a=e.$refs.menuTree.getCheckedNodes(!1,!0),l=[],o=[];a.forEach((e=>{e&&(1===e.menuType&&l.push(e._id),2===e.menuType&&o.push(e._id))})),r.rolePermission={checkedPages:l,checkedBtns:o}}!0===await l.roleOperate(r)?(t(!1),a(),e.$message.success(`${o.title} -> [${r.roleName}] 成功！`)):e.$message.warning(`${o.title} -> [${r.roleName}] 失败！`)}}))}}})(n,e.getRoleList))}},y=D("取 消"),P=D("确 定");b.render=function(e,a,l,o,t,r){const i=n("el-input"),s=n("el-form-item"),d=n("el-divider"),D=n("el-tree"),b=n("el-form"),w=n("el-button"),$=n("el-dialog");return c(),m($,{modelValue:e.dialogData.showDialog,"onUpdate:modelValue":a[4]||(a[4]=a=>e.dialogData.showDialog=a),title:e.dialogData.title},{footer:u((()=>[p(w,{onClick:a[3]||(a[3]=a=>e.handleToggleDialogShow(!1))},{default:u((()=>[y])),_:1}),p(w,{type:"primary",onClick:e.handleSubmitRoleOperate},{default:u((()=>[P])),_:1},8,["onClick"])])),default:u((()=>[p(b,{model:e.dialogData,rules:e.dialogDataRules,ref:"operateForm","label-position":"right","label-width":"6em"},{default:u((()=>[p(s,{label:"角色名称",prop:"roleName"},{default:u((()=>[p(i,{modelValue:e.dialogData.roleName,"onUpdate:modelValue":a[1]||(a[1]=a=>e.dialogData.roleName=a),placeholder:"请输入角色名称",autocomplete:"off",disabled:"setPermission"===e.dialogData.action},null,8,["modelValue","disabled"])])),_:1}),g(p(s,{label:"备注",prop:"remark"},{default:u((()=>[p(i,{type:"textarea",modelValue:e.dialogData.remark,"onUpdate:modelValue":a[2]||(a[2]=a=>e.dialogData.remark=a),placeholder:"请输入备注信息",autocomplete:"off"},null,8,["modelValue"])])),_:1},512),[[h,"setPermission"!=e.dialogData.action]]),"setPermission"===e.dialogData.action&&e.dialogData.showDialog?(c(),m(f,{key:0},[p(d),p(D,{ref:"menuTree","show-checkbox":"","default-expand-all":"","node-key":"_id",data:l.menuList,props:{children:"children",label:"menuName"}},null,8,["data"])],64)):k("",!0)])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])};export default b;
