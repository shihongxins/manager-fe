var e=Object.defineProperty,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,r=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,o=(e,o)=>{for(var s in o||(o={}))l.call(o,s)&&r(e,s,o[s]);if(a)for(var s of a(o))t.call(o,s)&&r(e,s,o[s]);return e};import{u as s}from"./index.a8eae04d.js";import u from"./UserOperateDialog.6e5dc788.js";import{s as i,v as n,u as p,x as d,r as m,y as g,o as c,c as b,a as h,w as f,z as y,F as D,d as w,e as _,A as S,b as C}from"./vendor.7002d699.js";const v={name:"Users",components:{UserOperateDialog:u},setup(){const{proxy:e}=S(),{tableColumns:a,userList:l,query:t,pageData:r,getUserList:u,handleQuerySubmit:m,showDialog:g}=(e=>{const a=i("$api"),l=[{label:"用户 ID",prop:"userId",width:80},{label:"用户名称",prop:"userName"},{label:"用户邮箱",prop:"userEmail",width:200},{label:"用户角色",prop:"role",formatter:(e,a,l)=>({0:"普通用户",1:"管理员"}[l])},{label:"用户状态",prop:"state",formatter:(e,a,l)=>({1:"试用",2:"在职",3:"离职"}[l])},{label:"注册时间",prop:"createTime",formatter:(e,a,l)=>s.formatterDateTime(l),width:90},{label:"最后登录",prop:"lastLoginTime",formatter:(e,a,l)=>s.formatterDateTime(l),width:90}],t=n([]),r=p({userId:"",userName:"",state:2}),u=p({pageNum:1,pageSize:10,total:0}),m=async()=>{const e=o(o({},u),r),{page:l,list:s}=await a.getUserList(e);l&&s&&(t.value=s,u.total=l.total)};return d((()=>{m()})),{tableColumns:l,userList:t,query:r,pageData:u,getUserList:m,handleQuerySubmit:a=>{const{reset:l,pageNum:t,pageSize:r}=a;l&&e.$refs.queryForm.resetFields(),u.pageNum=t||1,u.pageSize=r||10,m()},showDialog:(a,l,t)=>{e.$refs.userOperateDialog.handleToggleDialogShow(a,l,t)}}})(e);return o({tableColumns:a,userList:l,query:t,pageData:r,getUserList:u,handleQuerySubmit:m,showDialog:g},((e,a)=>{const l=i("$api"),t=n([]),r=async t=>{t.length>0?await l.userDel({userIds:t})>0?(e.$message.success("删除成功！"),a()):e.$message.error("删除失败！"):e.$message.warning("请先选中数据！")};return{handleSelectionChange:e=>{t.value=e},handleSingleDel:e=>{e&&e._id&&r([e.userId])},handlePatchDel:()=>{const e=[];t.value.forEach((a=>{a&&a._id&&e.push(a.userId)})),r(e)}}})(e,u))}},U={class:"content_wrapper"},z={class:"query_form_wrapper"},k=C("查询"),q=C("重置"),I={class:"table_container"},L={class:"table_tools"},N=C("新增"),O=C("批量删除"),V={class:"table_content"},j=C("编辑"),Q=C("删除");v.render=function(e,a,l,t,r,o){const s=m("el-input"),u=m("el-form-item"),i=m("el-option"),n=m("el-select"),p=m("el-button"),d=m("el-form"),S=m("el-table-column"),C=m("el-table"),v=m("el-pagination"),$=m("UserOperateDialog"),x=g("has");return c(),b("div",U,[h("div",z,[h(d,{inline:!0,model:t.query,ref:"queryForm"},{default:f((()=>[h(u,{label:"用户 ID",prop:"userId"},{default:f((()=>[h(s,{modelValue:t.query.userId,"onUpdate:modelValue":a[1]||(a[1]=e=>t.query.userId=e),placeholder:"请输入用户 ID"},null,8,["modelValue"])])),_:1}),h(u,{label:"用户名称",prop:"userName"},{default:f((()=>[h(s,{modelValue:t.query.userName,"onUpdate:modelValue":a[2]||(a[2]=e=>t.query.userName=e),placeholder:"请输入用户名称"},null,8,["modelValue"])])),_:1}),h(u,{label:"用户状态",prop:"state"},{default:f((()=>[h(n,{modelValue:t.query.state,"onUpdate:modelValue":a[3]||(a[3]=e=>t.query.state=e),placeholder:"请选择用户状态"},{default:f((()=>[h(i,{label:"所有",value:0}),h(i,{label:"试用",value:1}),h(i,{label:"在职",value:2}),h(i,{label:"离职",value:3})])),_:1},8,["modelValue"])])),_:1}),h(u,null,{default:f((()=>[h(p,{type:"primary",onClick:t.handleQuerySubmit},{default:f((()=>[k])),_:1},8,["onClick"]),h(p,{onClick:a[4]||(a[4]=e=>t.handleQuerySubmit({reset:!0}))},{default:f((()=>[q])),_:1})])),_:1})])),_:1},8,["model"])]),h("div",I,[h("div",L,[y(h(p,{type:"primary",onClick:a[5]||(a[5]=e=>t.showDialog(!0,"add"))},{default:f((()=>[N])),_:1},512),[[x,"user-add"]]),y(h(p,{type:"danger",onClick:e.handlePatchDel},{default:f((()=>[O])),_:1},8,["onClick"]),[[x,"user-patchDel"]])]),h("div",V,[h(C,{onSelectionChange:e.handleSelectionChange,data:t.userList,stripe:""},{default:f((()=>[h(S,{type:"selection",width:"55"}),(c(!0),b(D,null,w(t.tableColumns,(e=>(c(),b(S,{key:e.prop,prop:e.prop,label:e.label,width:e.width,formatter:e.formatter},null,8,["prop","label","width","formatter"])))),128)),h(S,{label:"操作"},{default:f((a=>[y(h(p,{size:"mini",onClick:e=>t.showDialog(!0,"edit",a.row)},{default:f((()=>[j])),_:2},1032,["onClick"]),[[x,"user-edit"]]),1!=a.row.role?y((c(),b(p,{key:0,size:"mini",type:"danger",onClick:l=>e.handleSingleDel(a.row)},{default:f((()=>[Q])),_:2},1032,["onClick"])),[[x,"user-singleDel"]]):_("",!0)])),_:1})])),_:1},8,["onSelectionChange","data"]),h(v,{onSizeChange:a[6]||(a[6]=e=>{t.handleQuerySubmit({pageSize:e})}),onCurrentChange:a[7]||(a[7]=e=>{t.handleQuerySubmit({pageNum:e})}),"current-page":t.pageData.pageNum,"onUpdate:current-page":a[8]||(a[8]=e=>t.pageData.pageNum=e),"page-sizes":[10,20,50,100],"page-size":t.pageData.pageSize,"onUpdate:page-size":a[9]||(a[9]=e=>t.pageData.pageSize=e),total:t.pageData.total,class:"table_pagination",layout:"total, sizes, prev, pager, next, jumper",background:""},null,8,["current-page","page-size","total"])])]),h($,{ref:"userOperateDialog",getUserList:t.getUserList},null,8,["getUserList"])])};export default v;
